# Insight Mesh Implementation TODO

## 1. Slack Chat Integration
- [x] **Create Slack App:**
  - Register a new Slack app and bot.
  - Set permissions: `chat:write`, `channels:history`, `users:read.email`, etc.
  - Install the app to your workspace and save the OAuth token.
- [x] **Implement Bot Listener:**
  - Use `slack_bolt` to listen for new messages and fetch message history.
  - Extract user ID and forward in auth header.
- [x] **Forward to LiteLLM:**
  - Send messages with `X-Auth-Token: slack:{user_id}` header.
  - Use LiteLLM proxy for consistent handling with OpenWebUI.
- [x] **Test End-to-End:**
  - Validate that the bot responds correctly
  - Verify auth token handling in RAG hook
  - Test user permissions and context retrieval
  - Ensure proper error handling and logging
- [x] **Implement AI Apps Features:**
  - Configure bot with new Slack AI Apps capabilities
  - Set up suggested prompts and thread status indicators
  - Migrate from Socket Mode to new AI Apps framework
- [x] **Add Agent Process Support:**
  - Implement background process execution from Slack
  - Create agent process definitions for common tasks
  - Add user-friendly status reporting
- [ ] **Enhance Source Citations:**
  - Add URLs to source citations in responses
  - Format citations to include document titles and types
  - Make cited sources clickable in Slack
  - Improve overall citation display format

## 1.1 Slack Agent Enhancements (MEDIUM PRIORITY)
- [ ] **Add More Agent Processes:**
  - Expand available agent processes to include data cleaning, analytics, and export functionality
  - Add specialized agents for different data sources
  - Implement parameterized processes that accept user inputs
- [ ] **Process Monitoring:**
  - Implement comprehensive job monitoring system for tracking progress of long-running jobs
  - Add notifications when jobs complete or encounter errors
  - Create job status dashboard accessible through bot commands
- [ ] **Process Output Reporting:**
  - Add automatic reporting capabilities that share job results directly in Slack
  - Include visualizations and summary statistics in reports
  - Allow reports to be saved and shared with team members
- [ ] **User-Specific Job History:**
  - Maintain per-user job history for review and auditing
  - Allow users to easily rerun previous jobs with same parameters
  - Implement job templates based on common usage patterns

## 2. MCP Server
- [x] **Scaffold API Server:**
  - Use FastAPI for the MCP server.
- [x] **Implement RAG Hook Endpoint:**
  - Accepts user message and context.
  - Enriches prompt using Elasticsearch, Neo4j, and permission logic.
  - Returns enriched prompt/context to LiteLLM.
- [x] **Integrate with Data Sources:**
  - Connect to Elasticsearch, Neo4j, and permissions DB.
  - Implement retrieval and enrichment logic.
- [x] **Authentication & Permissions:**
  - Handle both JWT and Slack auth tokens
  - Look up user info from appropriate sources
  - Apply permission filtering
- [x] **Test MCP Integration:** (HIGH PRIORITY)
  - Verify token handling for both auth types
  - Test user lookup and permission checks
  - Validate context retrieval and enrichment
  - Implement comprehensive test suite with test coverage reporting
- [ ] **Agent Management:** (MEDIUM PRIORITY)
  - Design endpoints for managing and visualizing business ops agents
  - Implement job scheduling and management API
  - Create monitoring endpoints for job status tracking
- [x] **Integrate WebCat with Serper.dev:** (HIGH PRIORITY)
  - Implement serper.dev integration for web search capabilities
  - Add support for news and image search APIs
  - Create unified API endpoints for search, news, and image retrieval
  - Ensure proper authentication and rate limiting
  - Configure as internal tool with externally exposed endpoint
  - Implement IP whitelisting for secured external access
  - Set up proper request logging and monitoring
- [ ] **Document API Contracts:** (HIGH PRIORITY)
  - Document auth token formats
  - Document request/response formats
  - Document integration points with LiteLLM

## 3. Infrastructure (HIGH PRIORITY)
- [ ] **Monitoring:**
  - Set up logging for auth token handling
  - Monitor token validation success/failure rates
  - Track context retrieval performance
  - Set up alerts for auth/permission issues
- [ ] **Observability & Log Monitoring:** (HIGH PRIORITY)
  - Implement centralized logging solution (ELK or similar)
  - Set up dashboards for real-time system visibility
  - Configure alerting based on log patterns and anomalies
  - Create performance metrics dashboards
  - Implement distributed tracing for request flows
  - Set up error rate and latency monitoring
  - Establish log retention and archiving policies
- [ ] **Security:**
  - Review token handling security
  - Audit permission checks
  - Monitor for unusual access patterns
  - Regular security reviews
- [ ] **Deployment:**
  - Finalize Docker container configurations
  - Set up container orchestration
  - Implement CI/CD pipeline for automated testing and deployment
  - Document deployment procedures

## 4. Admin Dashboard (HIGH PRIORITY)
- [ ] **Core Dashboard:**
  - Design and implement a central admin UI
  - Create authentication and authorization for admin users
  - Implement responsive design for desktop and mobile access
  - Set up secure access controls and audit logging
- [ ] **Logging & Monitoring Interface:**
  - Create log viewer with filtering and search capabilities
  - Implement system status dashboards and health metrics
  - Set up alert management and notification configuration
  - Add performance visualization tools
- [ ] **User Management:**
  - Implement user alias management and mapping
  - Create user permission configuration interface
  - Add user activity monitoring and reporting
  - Implement role-based access controls
- [ ] **System Configuration:**
  - Add interface for managing system settings
  - Create deployment and version management tools
  - Implement backup and restore functionality
  - Add integration management for connected systems

## 5. Search & NLP Improvements (LOW PRIORITY)
- [ ] **Entity Extraction Pipeline:**
  - Implement NLP entity extraction during indexing
  - Extract key entities (people, organizations, topics, etc.)
  - Store entities in Neo4j for relationship mapping
  - Add entity metadata to Elasticsearch documents
- [ ] **Hybrid Search Enhancement:**
  - Implement sparse embeddings (BM25) in Elasticsearch
  - Configure hybrid search combining dense and sparse vectors
  - Tune BM25 parameters for optimal results
  - Add field boosting for entity matches
- [ ] **Search Quality:**
  - Set up evaluation metrics for search quality
  - Implement A/B testing framework
  - Create test dataset with relevance judgments
  - Monitor search performance metrics
- [ ] **Integration:**
  - Update MCP server to use hybrid search
  - Modify context retrieval to leverage entities
  - Add entity-based filtering options
  - Update RAG prompt to use entity context

## 6. Testing & Documentation (HIGH PRIORITY)
- [x] **MCP Server Testing:**
  - Create comprehensive test plan
  - Implement unit tests for all components
  - Set up test coverage reporting
  - Document test scenarios and expectations
- [ ] **End-to-End Testing:**
  - Create comprehensive test plan for the entire system
  - Implement automated testing for critical paths
  - Document testing procedures and expected results
- [ ] **User Documentation:**
  - Create user guides for Slack interaction
  - Document available commands and agent processes
  - Provide troubleshooting information
- [ ] **Developer Documentation:**
  - Document system architecture
  - Create API documentation
  - Document deployment and maintenance procedures

## 7. Business Strategy (HIGH PRIORITY)
- [ ] **Pricing Model:**
  - Target $25-35/user/month for mid-market businesses (100-500 employees)
  - Client carries infrastructure and LLM API costs
  - We provide software, installation, configuration, and support
  - Client handles day-to-day operations and monitoring
- [ ] **Cost Structure Analysis:**
  - Calculate development and maintenance costs
  - Determine support requirements and associated costs
  - Set target margins (70-80%)
  - Establish pricing tiers based on company size/usage
- [ ] **Go-to-Market Strategy:**
  - Define ideal customer profile (mid-market, knowledge-intensive industries)
  - Create marketing materials highlighting knowledge management pain points
  - Develop ROI calculator to demonstrate value proposition
  - Design onboarding process for new clients
- [ ] **Support Model:**
  - Define SLAs for different pricing tiers
  - Establish support workflow and tooling
  - Create documentation for client operations teams
  - Develop training materials for client administrators